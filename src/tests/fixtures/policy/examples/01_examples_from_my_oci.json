{
  "schema_version": "1.0",
  "statements": [
    {
      "kind": "allow",
      "subject": {
        "type": "service",
        "values": [
          {
            "label": "example-lifecycle-service"
          }
        ]
      },
      "actions": {
        "type": "permissions",
        "values": [
          "iam_workrequest_read",
          "iam_workrequest_inspect"
        ]
      },
      "resources": {
        "type": "unknown",
        "values": []
      },
      "location": {
        "type": "tenancy",
        "values": []
      }
    },
    {
      "kind": "allow",
      "subject": {
        "type": "service",
        "values": [
          {
            "label": "example-lifecycle-service"
          }
        ]
      },
      "actions": {
        "type": "permissions",
        "values": [
          "policy_delete"
        ]
      },
      "resources": {
        "type": "unknown",
        "values": []
      },
      "location": {
        "type": "tenancy",
        "values": []
      },
      "conditions": {
        "type": "group",
        "mode": "all",
        "items": [
          {
            "type": "clause",
            "node": {
              "lhs": "target.policy.name",
              "op": "eq",
              "rhs": {
                "type": "literal",
                "value": "ExampleProvisioning"
              }
            }
          }
        ]
      }
    },
    {
      "kind": "allow",
      "subject": {
        "type": "service",
        "values": [
          {
            "label": "objectstorage-example-1"
          }
        ]
      },
      "actions": {
        "type": "verbs",
        "values": [
          "manage"
        ]
      },
      "resources": {
        "type": "specific",
        "values": [
          "object-family"
        ]
      },
      "location": {
        "type": "tenancy",
        "values": []
      }
    },
    {
      "kind": "allow",
      "subject": {
        "type": "any-user",
        "values": []
      },
      "actions": {
        "type": "verbs",
        "values": [
          "manage"
        ]
      },
      "resources": {
        "type": "all-resources",
        "values": []
      },
      "location": {
        "type": "compartment_name",
        "values": [
          "example-compartment"
        ]
      },
      "conditions": {
        "type": "group",
        "mode": "all",
        "items": [
          {
            "type": "clause",
            "node": {
              "lhs": "request.user.name",
              "op": "eq",
              "rhs": {
                "type": "regex",
                "value": "/__EXAMPLE__*/",
                "pattern": "__EXAMPLE__*"
              }
            }
          }
        ]
      }
    },
    {
      "kind": "allow",
      "subject": {
        "type": "group",
        "values": [
          {
            "label": "TeamAdmins",
            "identity_domain": "ExampleDomain"
          }
        ]
      },
      "actions": {
        "type": "verbs",
        "values": [
          "use"
        ]
      },
      "resources": {
        "type": "specific",
        "values": [
          "cloud-shell"
        ]
      },
      "location": {
        "type": "tenancy",
        "values": []
      }
    },
    {
      "kind": "allow",
      "subject": {
        "type": "group-id",
        "values": [
          {
            "label": "ocid1.group.oc1..examplegroup1"
          },
          {
            "label": "ocid1.group.oc1..examplegroup2"
          }
        ]
      },
      "actions": {
        "type": "verbs",
        "values": [
          "manage"
        ]
      },
      "resources": {
        "type": "all-resources",
        "values": []
      },
      "location": {
        "type": "compartment_name",
        "values": [
          "Projects-Example"
        ]
      }
    },
    {
      "kind": "allow",
      "subject": {
        "type": "group",
        "values": [
          {
            "label": "TeamA"
          }
        ]
      },
      "actions": {
        "type": "verbs",
        "values": [
          "manage"
        ]
      },
      "resources": {
        "type": "specific",
        "values": [
          "instance-family"
        ]
      },
      "location": {
        "type": "compartment-path",
        "values": [
          "Project-X",
          "Project-Y"
        ]
      }
    }
  ]
}
